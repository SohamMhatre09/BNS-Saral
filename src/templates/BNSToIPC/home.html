<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BNS Saral</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'BNSToIPC/style.css' %}">
</head>
<body>
    <div class="main-container">
        <div class="container1a"></div>
        <div class="container1">
            <h1>BNS Saral</h1>
        </div>
        <div class="container2">
            <form id="conversion-form" method="post">
                {% csrf_token %}
                <div class="form-item">
                    <div class="input1">
                        <label for="ipc">IPC:</label>
                        <input type="text" id="ipc" name="ipc" class="form-control" placeholder="Enter section number">
                        <label for="bns">BNS:</label>
                        <input type="text" id="bns" name="bns" class="form-control" placeholder="Enter section number" readonly>
                    </div>
                    <button type="button" id="convert-button">Convert</button>
                    <button type="reset" id="clear-button">Clear</button>
                </div>
            </form>
        </div>
        <div class="response-container">
            <button id="read-more-button">Read More</button>
            <div class="response" id="response" style="display: none;">
                <!-- Response content will be inserted here -->
            </div>
        </div>
    </div>
    <div style="text-align: center; padding: 50px; font-size: small;">
            Created by Mihir Pande
    </div>

    <script>
        // Get references to the input fields and buttons
        const ipcInput = document.getElementById('ipc');
        const bnsInput = document.getElementById('bns');
        const convertButton = document.getElementById('convert-button');

        // Add event listener to convert button
        convertButton.addEventListener('click', function() {
            const ipcValue = ipcInput.value.trim(); // Get IPC input value

            // Create form data
            const formData = new FormData();
            formData.append('section', ipcValue);
            formData.append('code_type', 'ipc to bns');

            // Make a POST request to server endpoint '/BNS/'
            fetch('/BNS/', {
                method: 'POST',
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}' // Ensure this is properly populated
                },
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                // Update the bns input field with the fetched data
                if (data.error) {
                    console.error('Error:', data.error);
                    bnsInput.value = ''; // Clear the input if there's an error
                } else {
                    bnsInput.value = data.bns; // Update with the fetched BNS value
                    // Example to show extra data in the response area
                    const responseDiv = document.getElementById('response');
                    responseDiv.innerHTML = `<p>BNS Data: ${data.bns_data}</p>`;
                    responseDiv.style.display = 'block'; // Show the response area
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });
    </script>
</body>
</html>
